---
title: "datafest 2017"
author: "Karen Diaz, Diana Fierros-Piña, Marisa Youngblood, Tara Marin, and Marta García"
date: "3/31/2017"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(lubridate)
library(ggplot2)
library(leaflet)
library(maps)

datafest <- clicks
```

```{r,message=FALSE}

datafest1 <- datafest %>%
  mutate(new_date_time = ymd_hms(date_time),
         srch_checkin = ymd(srch_ci),
         srch_co = ymd(srch_co)) %>%
  inner_join(destinations, by = "srch_destination_id") %>%
  select(user_location_country, 
         user_location_region,
         orig_destination_distance,
         srch_destination_id,
         srch_destination_name,
         srch_checkin, 
         is_booking) %>%
  filter(is_booking == '1', user_location_country == 'UNITED STATES OF AMERICA') %>%
  group_by(user_location_region) %>%
  count(pop_dest = srch_destination_name, sort = TRUE) %>%
  group_by(user_location_region) %>%
  slice(1:5) %>%
  arrange(desc(n))
```
###Filtering for Top 5 States
```{r}
topfive <- datafest1 %>%
  filter(user_location_region %in% c('CA', 'TX', 'FL', 'IL', 'NY'))
```
###Map
```{r}
usa <-map_data("usa")
ggplot() + geom_polygon(data = usa, aes(x=long, y = lat, group = group)) + coord_fixed(1.3)
```

